/*! NSPanel - v0.1.0 - 2013-10-27
* https://github.com/i5ting/nspanel.js
* Copyright (c) 2013 alfred.sang; Licensed MIT */
!function(a){function b(a){window.console&&window.console.log&&window.console.log("LOG: "+a)}function c(b,c){f(c),i(c),a("#"+b).animate({left:"100%",width:"100%"},c.animation.speed_out,function(){a(this).hide()})}function d(b,c){a("#"+b).show().animate({left:0,width:"100%"},c.animation.speed_in,function(){g(c)})}function e(c,d){var e=k(c,d);return a("#"+e).text().length>0?(b("已加载过此section  id="+e),void 0):(l(e,d),void 0)}function f(a){m(a).show()}function g(a){m(a).hide()}function h(a,b){a._viewstack.push(b)}function i(a){a._viewstack.pop()}function j(a){return 1==a._viewstack.length?0:a._viewstack.length-1}function k(b,c){var d=j(c)+"_"+b.item_number+"_"+a(b).attr("url").split("/").join("_");return d}function l(b,c){var d="<section id='"+b+"'></section>";a("body").append(d),a("#"+b).css(c.section_style)}function m(a){return a._viewstack.length<2?(b("stack exception...."),void 0):a._viewstack[a._viewstack.length-2]}a.fn.nspanel=function(f){var g=a.extend({},a.fn.nspanel.defaults,f),i=0;return this.each(function(){$this=a(this),i++,$this.item_number=i;var f=a.meta?a.extend({},g,$this.data()):g;0==f._viewstack.length&&f._viewstack.push(a(".panel_content").first());var l=k($this,f);b("_new_panel_id= "+l),e($this,f),$this.off("click").on("click",function(){a("#"+l).load(a(this).attr("url")+".html",function(){var b=a("#"+l);b.find(".back_button").closest("div.button_container").click(function(){c(l,f)}),h(f,b),f.click_cb(j(f),context.item_number),b.find(".sectionloader").nspanel(f)})}),$this.find("img").click(function(){d(l,f)}),a("body").hammer().on("swipeleft","section",function(){}).on("swiperight","section",function(){a(".back_button").closest("div.button_container").click()})})},a.fn.nspanel.defaults={section_style:{display:"block","z-index":1e3,background:"red",top:0,position:"absolute",left:"100%",height:"100%"},animation:{speed_in:600,speed_out:600},_current:{},_viewstack:[],click_cb:function(a,b){console.log("level="+a+",item_index="+b)}}}(jQuery);